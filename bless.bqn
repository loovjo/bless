# Converts an array of numbers to a space separated string
Arr2Msg â† 1âŠ¸â†“ âˆ˜ âˆ¾ âˆ˜ ((" "Ë™âˆ¾â€¢Fmt)Â¨)

# Inverts Arr2Msg
Msg2Arr â† â€¢BQNÂ¨ âˆ˜ ((âŠ¢-Ëœ+`Ã—Â¬)âˆ˜(' 'âŠ¸=) âŠ” âŠ¢)


Curses â‡ {ğ•¤
    âŸ¨exit_status, stdout, stderrâŸ© â† â€¢SH "python3"â€¿"bless.py"
    â€¢Delay 0.05 # hopefully the fifos will be opened and stuff

    {ğ•¤
        â€¢Out "bless.py error"
        â€¢Out "== stderr =="
        â€¢Out stderr
        â€¢Out "== =="
        "internal bless.py error" ! 1
    }âŸ(exit_statusâ‰ 0)@

    null â† stdout=@
    boci â‡ (0=+`null)/stdout
    bico â‡ (1=null-Ëœ+`null)/stdout
    logf â‡ (2=null-Ëœ+`null)/stdout

    Send â† {
        boci â€¢FBytes ğ•©âˆ¾<@
    }
    Recv â† {ğ•¤
        â€¢FChars bico
    }

    # Sets terminal mode to raw + cbreak
    Start â‡ SendâŸœ"start"

    # Clears screen
    Clear â‡ SendâŸœ"clear"

    PutText â‡ {xâ€¿y F text:
        Send "puttext " âˆ¾ (Arr2Msg xâ€¿y) âˆ¾ " " âˆ¾ (Arr2Msg @-Ëœtext)
    }

    MoveCursor â‡ {F xâ€¿y:
        Send "puttext " âˆ¾ (Arr2Msg xâ€¿y)
    }

    # Reads one char. Blocks if no character is available.
    # Input is buffered, so if mulitple chars are typed before this function is called, only the first one will be returned, then the second one etc.
    ReadChar â‡ {ğ•¤
        Send "readchar_block"
        @+â€¢BQN Recv @
    }

    # Dumps the entire input buffer
    ReadText â‡ {ğ•¤
        Send "readstr"
        @+Msg2Arr Recv @
    }
}
